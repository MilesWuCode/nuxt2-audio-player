(window.webpackJsonp=window.webpackJsonp||[]).push([[0,4],{252:function(e,t,o){var content=o(266);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(77).default)("4fd32cd1",content,!0,{sourceMap:!1})},255:function(e,t,o){"use strict";var n=o(3),r=o(256).start;n({target:"String",proto:!0,forced:o(257)},{padStart:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},256:function(e,t,o){var n=o(4),r=o(44),d=o(13),c=o(183),l=o(22),f=n(c),m=n("".slice),v=Math.ceil,h=function(e){return function(t,o,n){var c,h,y=d(l(t)),S=r(o),w=y.length,N=void 0===n?" ":d(n);return S<=w||""==N?y:((h=f(N,v((c=S-w)/N.length))).length>c&&(h=m(h,0,c)),e?y+h:h+y)}};e.exports={start:h(!1),end:h(!0)}},257:function(e,t,o){var n=o(62);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(n)},258:function(e,t,o){"use strict";var n=o(10),r=o(0),d=o(4),c=o(108),l=o(15),f=o(11),m=o(182),v=o(37),h=o(78),y=o(181),S=o(5),w=o(79).f,N=o(27).f,_=o(17).f,k=o(259),T=o(260).trim,x="Number",E=r.Number,P=E.prototype,O=r.TypeError,I=d("".slice),A=d("".charCodeAt),j=function(e){var t=y(e,"number");return"bigint"==typeof t?t:C(t)},C=function(e){var t,o,n,r,d,c,l,code,f=y(e,"number");if(h(f))throw O("Cannot convert a Symbol value to a number");if("string"==typeof f&&f.length>2)if(f=T(f),43===(t=A(f,0))||45===t){if(88===(o=A(f,2))||120===o)return NaN}else if(48===t){switch(A(f,1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+f}for(c=(d=I(f,2)).length,l=0;l<c;l++)if((code=A(d,l))<48||code>r)return NaN;return parseInt(d,n)}return+f};if(c(x,!E(" 0o1")||!E("0b1")||E("+0x1"))){for(var M,R=function(e){var t=arguments.length<1?0:E(j(e)),o=this;return v(P,o)&&S((function(){k(o)}))?m(Object(t),o,R):t},D=n?w(E):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),F=0;D.length>F;F++)f(E,M=D[F])&&!f(R,M)&&_(R,M,N(E,M));R.prototype=P,P.constructor=R,l(r,x,R)}},259:function(e,t,o){var n=o(4);e.exports=n(1..valueOf)},260:function(e,t,o){var n=o(4),r=o(22),d=o(13),c=o(261),l=n("".replace),f="["+c+"]",m=RegExp("^"+f+f+"*"),v=RegExp(f+f+"*$"),h=function(e){return function(t){var o=d(r(t));return 1&e&&(o=l(o,m,"")),2&e&&(o=l(o,v,"")),o}};e.exports={start:h(1),end:h(2),trim:h(3)}},261:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},262:function(e,t,o){o(3)({target:"Number",stat:!0},{isFinite:o(263)})},263:function(e,t,o){var n=o(0).isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&n(e)}},264:function(e,t,o){o(3)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},265:function(e,t,o){"use strict";o(252)},266:function(e,t,o){var n=o(76)(!1);n.push([e.i,".slider[data-v-7cae798d],audio[data-v-7cae798d]{width:100%}.slider[data-v-7cae798d]{display:block}.info[data-v-7cae798d]{font-size:14px}div[data-v-7cae798d]{margin-bottom:20px}",""]),e.exports=n},268:function(e,t,o){"use strict";o.r(t);o(255),o(14),o(110),o(109),o(258),o(262),o(264),o(38);var n={name:"AudioPlayer",filters:{secondsToString:function(e){var t=Math.floor(e);if(0===t)return"0:00";var o=Math.floor(t/3600),n=Math.floor((t-3600*o)/60),s=(t-3600*o-60*n).toString().padStart(2,"0");return t>=3600?"".concat(o.toString(),":").concat(n.toString().padStart(2,"0"),":").concat(s):t>=600?"".concat(n.toString().padStart(2,"0"),":").concat(s):"".concat(n,":").concat(s)}},props:{album:{type:Object||null,default:null},source:{type:Object||null,default:null}},data:function(){var e=this;return{uuid:Date.now(),audio:null,second:0,volume:Number(localStorage.playerVolume)||.5,rate:Number(localStorage.playerRate)||1,currentTime:0,logCurrentTime:0,duration:0,paused:!0,muted:!1,readyState:0,seekOffset:15,buffer:0,sliderProcess:function(t){return[[0,t[0],{backgroundColor:"#666"}],[t[0],e.buffer,{backgroundColor:"#999"}]]},sliderDotStyle:{backgroundColor:"#fff"},sliderRailStyle:{backgroundColor:"#ddd"},log:null}},computed:{currentPercent:{get:function(){return this.audio?0===this.duration?0:Math.floor(this.currentTime/this.duration*100)/100:0},set:function(e){return this.audio.currentTime=Math.floor(Number(this.audio.duration||0)*e),e}}},watch:{rate:function(e,t){Number(e)!==Number(t)&&(console.log({new:Number(e),old:Number(t)}),this.audio.playbackRate=localStorage.playerRate=Number(e))},volume:function(e,t){Number(e)!==Number(t)&&(console.log({new:Number(e),old:Number(t)}),this.audio.muted&&Number(e)>0&&(this.audio.muted=!1),this.audio.muted||(this.audio.volume=localStorage.playerVolume=Number(e)))},source:function(e){console.log("watch source"),this.logEnd("watch source",this.logCurrentTime),this.source&&(this.audio.src=this.source.file,this.audio.playbackRate=this.rate)}},mounted:function(){var e=this;this.$nextTick((function(){window.addEventListener("beforeunload",e.onBeforeunload),window.addEventListener("storage",e.eventStorage)})),this.initPlayer()},beforeDestroy:function(){window.removeEventListener("beforeunload",this.onBeforeunload),window.removeEventListener("storage",this.eventStorage)},methods:{eventStorage:function(e){"device"===e.key&&window.localStorage.getItem("device")!==this.uuid&&(this.pause(),new window.Notification("other tabs on play"),console.log("other tabs on play"))},initPlayer:function(){var e=this;this.audio=this.$refs.audio,this.audio.autoplay=!0,this.audio.playbackRate=this.rate,this.audio.volume=this.volume,this.paused=this.audio.paused,this.muted=this.audio.muted,this.readyState=Number(this.audio.readyState),this.audio.onprogress=function(){console.log("audio-event","progress")},this.audio.onplaying=function(){console.log("audio-event","playing")},this.audio.onwaiting=function(){console.log("audio-event","waiting")},this.audio.onseeking=function(){console.log("audio-event","seeking"),e.logEnd("onseeking",e.logCurrentTime)},this.audio.onseeked=function(){console.log("audio-event","seeked"),e.logStart("onseeked")},this.audio.onended=function(){console.log("audio-event","ended"),e.logEnd("onended",e.logCurrentTime),e.next()},this.audio.onloadedmetadata=function(){console.log("audio-event","loadedmetadata")},this.audio.onloadeddata=function(){console.log("audio-event","loadeddata")},this.audio.oncanplay=function(){console.log("audio-event","canplay")},this.audio.oncanplaythrough=function(){console.log("audio-event","canplaythrough"),e.readyState=Number(e.audio.readyState),e.initMedia()},this.audio.ondurationchange=function(){console.log("audio-event","durationchange"),e.duration=!Number.isFinite(e.audio.duration)||Number.isNaN(e.audio.duration)?0:Number(e.audio.duration||0)},this.audio.ontimeupdate=function(){!1===e.audio.paused&&(e.logCurrentTime=e.audio.currentTime),e.currentTime=Number(e.audio.currentTime);var t=e.audio.buffered.length,time=e.audio.currentTime;0===t&&(e.buffer=0);for(var i=0;i<t;i++)e.audio.buffered.start(i)<=time&&e.audio.buffered.end(i)>=time&&Number(e.audio.duration||0)>0&&(e.buffer=e.audio.buffered.end(i)/Number(e.audio.duration)*100)},this.audio.onplay=function(){console.log("audio-event","play"),e.paused=e.audio.paused,window.localStorage.getItem("device")!==e.uuid&&window.localStorage.setItem("device",e.uuid),e.logStart("onplay")},this.audio.onpause=function(){console.log("audio-event","pause",e.audio.paused),e.paused=e.audio.paused,e.logEnd("onpause",e.logCurrentTime)},this.audio.onratechange=function(){console.log("audio-event","ratechange"),e.rate!==e.audio.playbackRate&&(e.rate=e.audio.playbackRate)},this.audio.onvolumechange=function(){console.log("audio-event","volumechange",e.audio.muted,e.audio.volume),e.muted=e.audio.muted,e.audio.muted?e.volume=0:e.volume=e.audio.volume},this.audio.onsuspend=function(){e.paused=e.audio.paused,console.log("audio-event","suspend",e.audio.paused)},this.audio.onemptied=function(){e.logEnd("onemptied",e.logCurrentTime),e.duration=0,e.paused=e.audio.paused,e.readyState=Number(e.audio.readyState),console.log("audio-event","emptied")},this.audio.onstalled=function(){console.log("audio-event","stalled")},this.audio.onerror=function(){console.log("onerror",e.audio.error.code)}},initMedia:function(){var e=this;if("mediaSession"in window.navigator){window.navigator.mediaSession.metadata=new MediaMetadata({title:this.album.name,artist:this.source.artist,album:this.source.name,artwork:[{src:this.source.image,sizes:"256x256",type:"image/jpg"}]}),this.setPositionState(),window.navigator.mediaSession.setActionHandler("play",(function(){e.audio.play(),window.navigator.mediaSession.playbackState="playing"})),window.navigator.mediaSession.setActionHandler("pause",(function(){e.audio.pause(),window.navigator.mediaSession.playbackState="paused"})),window.navigator.mediaSession.setActionHandler("stop",(function(){e.stop(),window.navigator.mediaSession.playbackState="none"}));try{window.navigator.mediaSession.setActionHandler("seekto",(function(t){t.fastSeek&&"fastSeek"in e.audio?e.audio.fastSeek(t.seekTime):(e.audio.currentTime=t.seekTime,e.setPositionState())}))}catch(e){console.error(e)}window.navigator.mediaSession.setActionHandler("previoustrack",(function(){e.prev()})),window.navigator.mediaSession.setActionHandler("nexttrack",(function(){e.next()}))}},play:function(){console.log("click-event","play"),0!==Number(this.audio.readyState)&&this.audio.paused&&this.audio.play()},stop:function(){console.log("click-event","stop"),0!==Number(this.audio.readyState)&&(this.audio.pause(),this.audio.src="",this.$store.dispatch("player/stop"))},pause:function(){console.log("click-event","pause"),this.audio.paused||this.audio.pause()},backward:function(e){console.log("click-event","backward"),0!==Number(this.audio.readyState)&&0!==Number(this.audio.currentTime)&&(this.audio.currentTime=Math.max(Number(this.audio.currentTime)-e,0))},forward:function(e){console.log("click-event","forward"),0!==Number(this.audio.readyState)&&Number(this.audio.currentTime)!==Number(this.audio.duration)&&(this.audio.currentTime=Math.min(Number(this.audio.currentTime)+e,Number(this.audio.duration||0)))},mule:function(){this.audio.muted=!this.audio.muted},setPositionState:function(){Number.isNaN(this.audio.duration)||"setPositionState"in window.navigator.mediaSession&&window.navigator.mediaSession.setPositionState({duration:this.audio.duration,playbackRate:this.audio.playbackRate,position:this.audio.currentTime})},consoleAudio:function(){console.dir(this.audio)},prev:function(){this.$store.dispatch("player/prev")},next:function(){this.$store.dispatch("player/next")},loop:function(){this.$store.dispatch("player/loop")},onBeforeunload:function(){this.logEnd("beforeunload",this.logCurrentTime)},logStart:function(e){console.log("logStart",e,this.audio.currentTime),this.log={id:this.source.id,startSec:this.audio.currentTime,endSec:this.audio.currentTime,diffSec:0,startTimestamp:parseInt(Date.now()/1e3),endTimestamp:parseInt(Date.now()/1e3)}},logEnd:function(e,t){this.log?t-this.log.startSec<3||(console.log("logEnd",e,t),this.log.endSec=t,this.log.diffSec=t-this.log.startSec,this.log.endTimestamp=parseInt(Date.now()/1e3),console.table({event:e,id:this.log.id,start:this.log.startSec,end:this.log.endSec,diff:this.log.diffSec}),this.log=null):console.log("logEnd","log is null")},useNotify:function(){window.Notification.requestPermission()}}},r=(o(265),o(43)),component=Object(r.a)(n,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("p",[e._v("\n    uuid : "+e._s(e.uuid)+"\n  ")]),e._v(" "),o("div",[o("div",[o("p",{staticClass:"info"},[e._v("\n        "+e._s(e.source&&e.source.id)+" - "+e._s(e.source&&e.source.name)+"\n      ")]),e._v(" "),o("p",{staticClass:"info"},[e._v("\n        "+e._s(e._f("secondsToString")(e.currentTime))+" / "+e._s(e._f("secondsToString")(e.duration))+"\n      ")]),e._v(" "),o("div",{staticClass:"slider"},[o("VueSlider",{attrs:{contained:!0,disabled:4!==e.readyState,"dot-style":e.sliderDotStyle,"drag-on-click":!0,interval:.01,max:1,min:0,process:e.sliderProcess,"rail-style":e.sliderRailStyle,"use-keyboard":!1,tooltip:"none"},model:{value:e.currentPercent,callback:function(t){e.currentPercent=t},expression:"currentPercent"}})],1)]),e._v(" "),o("div",[o("button",{attrs:{disabled:4!==e.readyState},on:{click:e.stop}},[e._v("Stop")]),e._v("\n      |\n      "),o("button",{attrs:{disabled:!e.paused||4!==e.readyState},on:{click:e.play}},[e._v("\n        Play\n      ")]),e._v(" "),o("button",{attrs:{disabled:e.paused},on:{click:e.pause}},[e._v("Pause")]),e._v("\n      |\n      "),o("button",{attrs:{disabled:4!==e.readyState},on:{click:function(t){return e.backward(e.seekOffset)}}},[e._v("\n        -15s\n      ")]),e._v(" "),o("button",{attrs:{disabled:4!==e.readyState},on:{click:function(t){return e.forward(e.seekOffset)}}},[e._v("\n        +15s\n      ")]),e._v("\n      |\n      "),o("button",{on:{click:e.loop}},[e._v("loop")]),e._v(" "),o("button",{on:{click:e.prev}},[e._v("prev")]),e._v(" "),o("button",{on:{click:e.next}},[e._v("next")]),e._v("\n      |\n      "),o("button",{on:{click:e.mule}},[e._v("mute")])]),e._v(" "),o("div",[o("p",[e._v("\n        volume:\n        "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.volume,expression:"volume"}],attrs:{type:"range",min:"0",max:"1",step:"0.01"},domProps:{value:e.volume},on:{__r:function(t){e.volume=t.target.value}}}),e._v("\n        "+e._s(e.volume)+"\n        "),o("span",{directives:[{name:"show",rawName:"v-show",value:e.muted,expression:"muted"}],staticStyle:{color:"red"}},[e._v("muted")])]),e._v(" "),o("p",[e._v("\n        rate:\n        "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.rate,expression:"rate"}],attrs:{type:"range",min:"0.5",max:"2.0",step:"0.25"},domProps:{value:e.rate},on:{__r:function(t){e.rate=t.target.value}}}),e._v("\n        "+e._s(e.rate)+"\n      ")])])]),e._v(" "),o("hr"),e._v(" "),o("div",[o("audio",{ref:"audio",attrs:{controls:""}}),e._v(" "),o("button",{on:{click:e.consoleAudio}},[e._v("console audio")]),e._v(" "),o("button",{on:{click:e.useNotify}},[e._v("use Notify")])])])}),[],!1,null,"7cae798d",null);t.default=component.exports},272:function(e,t,o){"use strict";o.r(t);o(46),o(28),o(45),o(14),o(80),o(39),o(81);var n=o(35),r=o(75);function d(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,o)}return t}var c={name:"AudioControll",computed:function(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}({},Object(r.b)({album:function(e){return e.player.album},source:function(e){return e.player.current}}))},l=c,f=o(43),component=Object(f.a)(l,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("AudioPlayer",{attrs:{album:e.album,source:e.source}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{AudioPlayer:o(268).default})}}]);